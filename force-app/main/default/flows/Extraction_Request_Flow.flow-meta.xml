<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <apiVersion>53.0</apiVersion>
    <assignments>
        <name>assignProviderExist1</name>
        <label>assignProviderExist1</label>
        <locationX>1077</locationX>
        <locationY>163</locationY>
        <assignmentItems>
            <assignToReference>providerExist</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>ER_PayrollSelected</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>CheckProviderLoop.ER_Value__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>EntryCheck</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>assignProviderExist2</name>
        <label>assignProviderExist2</label>
        <locationX>853</locationX>
        <locationY>337</locationY>
        <assignmentItems>
            <assignToReference>providerExist</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>EntryCheck</targetReference>
        </connector>
    </assignments>
    <choices>
        <name>No</name>
        <choiceText>No</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>No</stringValue>
        </value>
    </choices>
    <choices>
        <name>Yes</name>
        <choiceText>Yes</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Yes</stringValue>
        </value>
    </choices>
    <decisions>
        <name>CheckContactExist</name>
        <label>CheckContactExist</label>
        <locationX>744</locationX>
        <locationY>511</locationY>
        <defaultConnector>
            <targetReference>Contact_Not_Exist</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>contactExist</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>getContactRecords</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Extraction_Request_Screen</targetReference>
            </connector>
            <label>contactExist</label>
        </rules>
    </decisions>
    <decisions>
        <name>Entry_Check_Provider1</name>
        <label>Entry Check Provider1</label>
        <locationX>1309</locationX>
        <locationY>314</locationY>
        <defaultConnector>
            <targetReference>Error_Screen1</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Display Both Error</defaultConnectorLabel>
        <rules>
            <name>Entry_Check_Provider</name>
            <conditionLogic>NOT(1)</conditionLogic>
            <conditions>
                <leftValueReference>providerExist</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Error_Screen2</targetReference>
            </connector>
            <label>Entry Check Provider</label>
        </rules>
    </decisions>
    <decisions>
        <name>Entry_Check_Provider2</name>
        <label>Entry Check Provider2</label>
        <locationX>1068</locationX>
        <locationY>631</locationY>
        <defaultConnector>
            <targetReference>GetAccountRecord</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>EntryCheckProvider2</name>
            <conditionLogic>1</conditionLogic>
            <conditions>
                <leftValueReference>ProviderExisting</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Error_Screen_3</targetReference>
            </connector>
            <label>EntryCheckProvider2</label>
        </rules>
    </decisions>
    <decisions>
        <name>EntryCheck</name>
        <label>EntryCheck</label>
        <locationX>1065</locationX>
        <locationY>331</locationY>
        <defaultConnector>
            <targetReference>Entry_Check_Provider1</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>CheckStatusError</defaultConnectorLabel>
        <rules>
            <name>Entry_Check_Status</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>recordId.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Verbal Commit</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>recordId.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Sold - Submitted to CTT</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>recordId.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Sold</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>recordId.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Sold - Commissioned</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>recordId.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Sold â€“ Submitted</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>recordId.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Sold - Submitted</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>recordId.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Sold - Started</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Entry_Check_Provider2</targetReference>
            </connector>
            <label>Entry Check Status</label>
        </rules>
    </decisions>
    <decisions>
        <name>providerExistOppCheck</name>
        <label>providerExistOppCheck</label>
        <locationX>441</locationX>
        <locationY>50</locationY>
        <defaultConnector>
            <targetReference>CheckProviderLoop</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>ProviderExisting</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>CheckProviderLoop.Opp_Key__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>recordId.Payroll_Current_Prior_Method__c</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>assignProviderExist1</targetReference>
            </connector>
            <label>ProviderExisting</label>
        </rules>
    </decisions>
    <description>Allow Reps to submit request for Extraction
APR0161586 update 1/11/2024</description>
    <dynamicChoiceSets>
        <name>ContactList</name>
        <dataType>String</dataType>
        <displayField>Name</displayField>
        <filterLogic>and</filterLogic>
        <filters>
            <field>AccountId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>GetAccountRecord.Id</elementReference>
            </value>
        </filters>
        <object>Contact</object>
        <valueField>Id</valueField>
    </dynamicChoiceSets>
    <dynamicChoiceSets>
        <name>ER_PayrollCurrentPriorMethod</name>
        <dataType>Picklist</dataType>
        <displayField xsi:nil="true"/>
        <object xsi:nil="true"/>
        <picklistField>Payroll_Current_Prior_Method__c</picklistField>
        <picklistObject>Extraction_Request__c</picklistObject>
    </dynamicChoiceSets>
    <dynamicChoiceSets>
        <name>Opportunity_Service_Location</name>
        <dataType>Picklist</dataType>
        <displayField xsi:nil="true"/>
        <object xsi:nil="true"/>
        <picklistField>Service_Location__c</picklistField>
        <picklistObject>Opportunity</picklistObject>
    </dynamicChoiceSets>
    <dynamicChoiceSets>
        <name>SubmissionMethod</name>
        <dataType>Picklist</dataType>
        <displayField xsi:nil="true"/>
        <object xsi:nil="true"/>
        <picklistField>Submission_Method__c</picklistField>
        <picklistObject>Extraction_Request__c</picklistObject>
    </dynamicChoiceSets>
    <environments>Default</environments>
    <interviewLabel>Extraction Request Flow {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Extraction Request Flow</label>
    <loops>
        <name>CheckProviderLoop</name>
        <label>CheckProviderLoop</label>
        <locationX>675</locationX>
        <locationY>342</locationY>
        <collectionReference>GetProviderValues</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>providerExistOppCheck</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>assignProviderExist2</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>FREE_FORM_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>Flow</processType>
    <recordCreates>
        <name>Case_Record</name>
        <label>Case Record</label>
        <locationX>522</locationX>
        <locationY>896</locationY>
        <connector>
            <targetReference>GetCase_Record</targetReference>
        </connector>
        <inputAssignments>
            <field>AccountId</field>
            <value>
                <elementReference>recordId.Account.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ContactId</field>
            <value>
                <elementReference>getSelectedContact.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Contact_Email__c</field>
            <value>
                <elementReference>Please_provide_contacts_email_address</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Description</field>
            <value>
                <stringValue>Extraction Request Submission</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Opportunity__c</field>
            <value>
                <elementReference>recordId.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>OwnerId</field>
            <value>
                <elementReference>getMPSCRecordQueue.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Priority</field>
            <value>
                <stringValue>Normal</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>RecordTypeId</field>
            <value>
                <elementReference>getCaseRecordTypeId.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Service_Location__c</field>
            <value>
                <elementReference>recordId.Service_Location__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Status</field>
            <value>
                <stringValue>New</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Subject</field>
            <value>
                <stringValue>Extraction Request Submission</stringValue>
            </value>
        </inputAssignments>
        <object>Case</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Extraction_Request_Record</name>
        <label>Extraction Request Record</label>
        <locationX>902</locationX>
        <locationY>896</locationY>
        <connector>
            <targetReference>GetExtractionRequest_Record</targetReference>
        </connector>
        <inputAssignments>
            <field>Account__c</field>
            <value>
                <elementReference>recordId.Account.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Additional_Information__c</field>
            <value>
                <elementReference>Additional_Information</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Case__c</field>
            <value>
                <elementReference>GetCase_Record.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Contact_Email__c</field>
            <value>
                <elementReference>Please_provide_contacts_email_address</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Contact_name__c</field>
            <value>
                <elementReference>Contact_Name</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Date_final_payroll_processed__c</field>
            <value>
                <elementReference>Date_final_payroll_processed</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ERTC__c</field>
            <value>
                <elementReference>ERTC</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Federal_ID_Number__c</field>
            <value>
                <elementReference>Federal_ID_Number</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Number_of_IDs__c</field>
            <value>
                <elementReference>Number_of_IDs</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Opportunity__c</field>
            <value>
                <elementReference>recordId.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>OwnerId</field>
            <value>
                <elementReference>getMPSCRecordQueue.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Payroll_Current_Prior_Method__c</field>
            <value>
                <elementReference>Payroll_Current_Prior_Method</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Per_pay_period_extraction_required__c</field>
            <value>
                <elementReference>Per_pay_period_extraction_required</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Service_Location__c</field>
            <value>
                <elementReference>Service_Location</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Status__c</field>
            <value>
                <stringValue>New</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Submission_Method__c</field>
            <value>
                <elementReference>SubmissionMethod</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>X1099_Employees__c</field>
            <value>
                <elementReference>X1099_Employees</elementReference>
            </value>
        </inputAssignments>
        <object>Extraction_Request__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordLookups>
        <description>Account associated with Opportunity</description>
        <name>GetAccountRecord</name>
        <label>GetAccountRecord</label>
        <locationX>915</locationX>
        <locationY>659</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>getContactRecords</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId.Account.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Account</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>GetCase_Record</name>
        <label>GetCase Record</label>
        <locationX>699</locationX>
        <locationY>896</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Extraction_Request_Record</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Case_Record</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Case</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>getCaseRecordTypeId</name>
        <label>getCaseRecordTypeId</label>
        <locationX>325</locationX>
        <locationY>895</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Case_Record</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>DeveloperName</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>MPSC_Implementation_Data_Collection</stringValue>
            </value>
        </filters>
        <filters>
            <field>SobjectType</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Case</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>RecordType</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>getContactRecords</name>
        <label>getContactRecords</label>
        <locationX>887</locationX>
        <locationY>490</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>CheckContactExist</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>AccountId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>GetAccountRecord.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Contact</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>GetExtractionRequest_Record</name>
        <label>GetExtractionRequest Record</label>
        <locationX>1213</locationX>
        <locationY>910</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Review_Record</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Extraction_Request_Record</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Extraction_Request__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>getMPSCRecordQueue</name>
        <label>getMPSCRecordQueue</label>
        <locationX>323</locationX>
        <locationY>724</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>getCaseRecordTypeId</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>DeveloperName</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>MPSC_Implementation_Support</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Group</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>Valid Provider to submit extraction request- Payroll Current Prior Method</description>
        <name>GetProviderValues</name>
        <label>GetProviderValues</label>
        <locationX>563</locationX>
        <locationY>280</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>CheckProviderLoop</targetReference>
        </connector>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>ER_PayrollCurrentPriorMethod__mdt</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>getSelectedContact</name>
        <label>getSelectedContact</label>
        <locationX>325</locationX>
        <locationY>404</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>checkemailEntry</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Contact_Name</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Contact</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <screens>
        <name>checkemailEntry</name>
        <label>checkemailEntry</label>
        <locationX>324</locationX>
        <locationY>530</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>getMPSCRecordQueue</targetReference>
        </connector>
        <fields>
            <name>askEnterDetail</name>
            <fieldText>&lt;p&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;ï»¿The Selected contact is &lt;/span&gt;&lt;b style=&quot;color: rgb(0, 0, 0);&quot;&gt;{!getSelectedContact.Name}.&lt;/b&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Please_provide_contacts_email_address</name>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>getSelectedContact.Email</elementReference>
            </defaultValue>
            <fieldText>Please provide contacts email address</fieldText>
            <fieldType>InputField</fieldType>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
        </fields>
        <nextOrFinishButtonLabel>Continue</nextOrFinishButtonLabel>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Contact_Not_Exist</name>
        <label>Contact Not Exist</label>
        <locationX>488</locationX>
        <locationY>586</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <fields>
            <name>No_Contact</name>
            <fieldText>&lt;p&gt;&lt;b style=&quot;color: rgb(231, 29, 14); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, Oxygen, Ubuntu, &amp;quot;Fira Sans&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);&quot;&gt;No Contact exists for Account- &lt;/b&gt;&lt;span style=&quot;color: rgb(23, 43, 77); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, Oxygen, Ubuntu, &amp;quot;Fira Sans&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);&quot;&gt;{!GetAccountRecord.Name}. &lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;color: rgb(23, 43, 77); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, Oxygen, Ubuntu, &amp;quot;Fira Sans&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);&quot;&gt;Please exit the form and relaunch after adding the contact record to the account.&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <nextOrFinishButtonLabel>Exit</nextOrFinishButtonLabel>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Error_Screen1</name>
        <label>Error Screen1</label>
        <locationX>1528</locationX>
        <locationY>380</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <fields>
            <name>ExtractionRequestRecordErrorDetail</name>
            <fieldText>&lt;p&gt;&lt;strong style=&quot;font-size: 18px;&quot;&gt;ï»¿&lt;/strong&gt;&lt;strong style=&quot;font-size: 16px;&quot;&gt;Opportunity Status : &lt;/strong&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;{!recordId.StageName}&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 16px; background-color: rgb(255, 255, 255); font-family: -apple-system, &amp;quot;Segoe UI&amp;quot;, &amp;quot;Segoe UI Emoji&amp;quot;, sans-serif, Meiryo; color: rgb(218, 26, 26);&quot;&gt;Status must be Verbal Commit or higher to submit Extraction Request&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;strong style=&quot;font-size: 16px; background-color: rgb(255, 255, 255);&quot;&gt;Payroll Current/Prior Method : &lt;/strong&gt;&lt;span style=&quot;font-size: 18px; background-color: rgb(255, 255, 255);&quot;&gt;{!recordId.Payroll_Current_Prior_Method__c}&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;color: rgb(228, 21, 21); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, Oxygen, Ubuntu, &amp;quot;Fira Sans&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);&quot;&gt;Data extraction is not available for the provider entered in the Payroll Current/Prior Method. To process an extraction request this field must be updated on the Opportunity to reflect one of the acceptable prior methods. Eligible prior providers include: &lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;color: rgb(228, 21, 21); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, Oxygen, Ubuntu, &amp;quot;Fira Sans&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);&quot;&gt; {!$Label.ER_PayrollCurrentPriorMethod}&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Error_Screen2</name>
        <label>Error Screen2</label>
        <locationX>1525</locationX>
        <locationY>267</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <fields>
            <name>ExtractionRequestError</name>
            <fieldText>&lt;p&gt;&lt;strong style=&quot;font-size: 16px;&quot;&gt;Opportunity Status : &lt;/strong&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;{!recordId.StageName}&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;strong style=&quot;color: rgb(218, 26, 26); font-family: -apple-system, &amp;quot;Segoe UI&amp;quot;, &amp;quot;Segoe UI Emoji&amp;quot;, sans-serif, Meiryo; background-color: rgb(255, 255, 255); font-size: 16px;&quot;&gt;Status must be Verbal Commit or higher to submit Extraction Request&lt;/strong&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Error_Screen_3</name>
        <label>Error Screen 3</label>
        <locationX>1547</locationX>
        <locationY>624</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <fields>
            <name>DisplayProviderError</name>
            <fieldText>&lt;p&gt;&lt;b style=&quot;font-size: 16px; background-color: rgb(255, 255, 255);&quot;&gt;Payroll Current/Prior Method : &lt;/b&gt;&lt;span style=&quot;font-size: 18px; background-color: rgb(255, 255, 255);&quot;&gt;{!recordId.Payroll_Current_Prior_Method__c}&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;color: rgb(228, 21, 21); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, Oxygen, Ubuntu, &amp;quot;Fira Sans&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);&quot;&gt;Data extraction is not available for the provider entered in the Payroll Current/Prior Method. To process an extraction request this field must be updated on the Opportunity to reflect one of the acceptable prior methods. Eligible prior providers include: &lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;color: rgb(228, 21, 21); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, Oxygen, Ubuntu, &amp;quot;Fira Sans&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);&quot;&gt;{!$Label.ER_PayrollCurrentPriorMethod}&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Extraction_Request_Screen</name>
        <label>Extraction Request Screen</label>
        <locationX>496</locationX>
        <locationY>423</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>getSelectedContact</targetReference>
        </connector>
        <fields>
            <name>ExtractionRequestForm</name>
            <fieldText>&lt;p&gt;Client Name  :  {!GetAccountRecord.Name}&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Client Id : {!GetAccountRecord.AccountNumber}&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Submission_Method</name>
            <choiceReferences>SubmissionMethod</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Submission Method</fieldText>
            <fieldType>DropdownBox</fieldType>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <fieldType>ObjectProvided</fieldType>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>false</isRequired>
            <objectFieldReference>GetExtractionRequest_Record.Has_final_check_date_been_processed__c</objectFieldReference>
        </fields>
        <fields>
            <fieldType>ObjectProvided</fieldType>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>false</isRequired>
            <objectFieldReference>GetExtractionRequest_Record.Justified_Business_Reason__c</objectFieldReference>
        </fields>
        <fields>
            <name>Other_Business_Reason</name>
            <dataType>String</dataType>
            <fieldText>Other Business Reason</fieldText>
            <fieldType>InputField</fieldType>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>false</isRequired>
            <visibilityRule>
                <conditionLogic>1</conditionLogic>
                <conditions>
                    <leftValueReference>GetExtractionRequest_Record.Justified_Business_Reason__c</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>Other</stringValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <fieldType>ObjectProvided</fieldType>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>false</isRequired>
            <objectFieldReference>GetExtractionRequest_Record.Approval_Received__c</objectFieldReference>
        </fields>
        <fields>
            <name>Attachment_Option</name>
            <extensionName>forceContent:fileUpload</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>Attachment Option</stringValue>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
            <visibilityRule>
                <conditionLogic>or</conditionLogic>
                <conditions>
                    <leftValueReference>GetExtractionRequest_Record.Payroll_Current_Prior_Method__c</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>SurePayroll</stringValue>
                    </rightValue>
                </conditions>
                <conditions>
                    <leftValueReference>GetExtractionRequest_Record.Payroll_Current_Prior_Method__c</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>Paychex to Paychex</stringValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>Federal_ID_Number</name>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>recordId.Account.Federal_ID_Number__c</elementReference>
            </defaultValue>
            <fieldText>Federal ID Number</fieldText>
            <fieldType>InputField</fieldType>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>Service_Location</name>
            <choiceReferences>Opportunity_Service_Location</choiceReferences>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>recordId.Service_Location__c</elementReference>
            </defaultValue>
            <fieldText>Service Location</fieldText>
            <fieldType>DropdownBox</fieldType>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>false</isRequired>
        </fields>
        <fields>
            <name>Payroll_Current_Prior_Method</name>
            <choiceReferences>ER_PayrollCurrentPriorMethod</choiceReferences>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>ER_PayrollSelected</elementReference>
            </defaultValue>
            <fieldText>Payroll Current/Prior Method</fieldText>
            <fieldType>DropdownBox</fieldType>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>Number_of_IDs</name>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>Number_of_IDs</elementReference>
            </defaultValue>
            <fieldText>Number of IDs?</fieldText>
            <fieldType>InputField</fieldType>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>Contact_Name</name>
            <choiceReferences>ContactList</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Contact Name</fieldText>
            <fieldType>DropdownBox</fieldType>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>Date_final_payroll_processed</name>
            <dataType>Date</dataType>
            <defaultValue>
                <elementReference>Date_final_payroll_processed</elementReference>
            </defaultValue>
            <fieldText>Date final payroll processed?</fieldText>
            <fieldType>InputField</fieldType>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <validationRule>
                <errorMessage>&lt;p&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, Oxygen, Ubuntu, &amp;quot;Fira Sans&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, sans-serif; color: rgb(0, 51, 102);&quot;&gt;Date must be in the past or within 2 business days of submission.&lt;/span&gt;&lt;/p&gt;</errorMessage>
                <formulaExpression>IF(OR(MOD(TODAY() - DATE( 1900, 1, 7 ), 7 ) =5,MOD(TODAY() - DATE( 1900, 1, 7 ), 7 ) =4),
   {!Date_final_payroll_processed} &lt;= TODAY()+4,
   {!Date_final_payroll_processed} &lt;= TODAY()+2 
	 
   )</formulaExpression>
            </validationRule>
        </fields>
        <fields>
            <fieldType>ObjectProvided</fieldType>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>false</isRequired>
            <objectFieldReference>recordId.CloseDate</objectFieldReference>
        </fields>
        <fields>
            <name>X1099_Employees</name>
            <choiceReferences>Yes</choiceReferences>
            <choiceReferences>No</choiceReferences>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>X1099_Employees</elementReference>
            </defaultValue>
            <fieldText>1099 Employees?</fieldText>
            <fieldType>DropdownBox</fieldType>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>Per_pay_period_extraction_required</name>
            <choiceReferences>Yes</choiceReferences>
            <choiceReferences>No</choiceReferences>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>Per_pay_period_extraction_required</elementReference>
            </defaultValue>
            <fieldText>Per pay period (PPP) extraction required?</fieldText>
            <fieldType>DropdownBox</fieldType>
            <helpText>&lt;p&gt;PPP and ERTC require per pay period extraction.&lt;/p&gt;</helpText>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>ERTC</name>
            <choiceReferences>Yes</choiceReferences>
            <choiceReferences>No</choiceReferences>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>ERTC</elementReference>
            </defaultValue>
            <fieldText>ERTC?</fieldText>
            <fieldType>DropdownBox</fieldType>
            <helpText>&lt;p&gt;Did this client select the ERTC product?&lt;/p&gt;</helpText>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <fieldType>ObjectProvided</fieldType>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>false</isRequired>
            <objectFieldReference>GetExtractionRequest_Record.Is_this_a_943_944_filer__c</objectFieldReference>
        </fields>
        <fields>
            <name>Additional_Information</name>
            <defaultValue>
                <stringValue>{!Additional_Information}</stringValue>
            </defaultValue>
            <fieldText>Additional Information</fieldText>
            <fieldType>LargeTextArea</fieldType>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>false</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Review_Record</name>
        <label>Review Record</label>
        <locationX>1545</locationX>
        <locationY>909</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <fields>
            <name>ReviewRecord</name>
            <fieldText>&lt;p&gt;&lt;b style=&quot;font-size: 16px;&quot;&gt;Extraction Request Record  :   &lt;/b&gt;&lt;b style=&quot;font-size: 14px;&quot;&gt;{!GetExtractionRequest_Record.Name} &lt;/b&gt;&lt;b style=&quot;font-size: 16px; color: rgb(0, 0, 0);&quot;&gt;Created Successfully .&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b style=&quot;font-size: 14px;&quot;&gt;Opportunity Name : {!recordId.Name}&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b style=&quot;font-size: 14px;&quot;&gt;Prospect Client Name : {!recordId.Account.Name}&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b style=&quot;font-size: 14px;&quot;&gt;Contact : {!Contact_Name}&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b style=&quot;font-size: 14px;&quot;&gt;Contact Email : {!Please_provide_contacts_email_address}&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b style=&quot;font-size: 14px;&quot;&gt;Case : {!GetCase_Record.CaseNumber}&lt;/b&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <nextOrFinishButtonLabel>Close</nextOrFinishButtonLabel>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <start>
        <locationX>200</locationX>
        <locationY>263</locationY>
        <connector>
            <targetReference>GetProviderValues</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <variables>
        <name>ER_PayrollSelected</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>providerExist</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <booleanValue>false</booleanValue>
        </value>
    </variables>
    <variables>
        <description>Opportunity Record</description>
        <name>recordId</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
        <objectType>Opportunity</objectType>
    </variables>
</Flow>
