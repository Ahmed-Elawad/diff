<?xml version="1.0" encoding="UTF-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>MPSC_ServiceHelp_Case_Status_restriction</fullName>
    <active>true</active>
    <errorConditionFormula>AND(
 RecordType.DeveloperName ==&quot;Multi_Product_Service_Case&quot;,
 NOT(ISNEW()),
 ISCHANGED( Status ),
 $Profile.Name==&quot;Mid-Market Service Profile&quot;,
 ISPICKVAL(Type, &quot;Service Help&quot;), 
  NOT(
   AND(
    ISPICKVAL(PRIORVALUE(Status), &quot;New&quot;),
    ISPICKVAL(Status, &quot;Cancelled&quot;)
   )
  ),
  NOT(
   AND(
    ISPICKVAL(PRIORVALUE(Status), &quot;New&quot;),
    ISPICKVAL(Status, &quot;Closed&quot;)
   )
  ),
  NOT(
   AND(
    ISPICKVAL(PRIORVALUE(Status),&quot;New&quot;),
    ISPICKVAL(Status, &quot;Submitted&quot;)
   )
  ),
  NOT(
   AND(
    ISPICKVAL(PRIORVALUE(Status),&quot;Approved/Ready&quot;),
    ISPICKVAL(Status, &quot;Submitted&quot;)
   )
  ),
  NOT(
   AND(
    ISPICKVAL(PRIORVALUE(Status),&quot;New&quot;),
    ISPICKVAL(Status, &quot;Closed - Rejected&quot;),
	$Permission.Mid_Market_Project_Team_Status_Change_Access
   )
  ),
  NOT(
   AND(
    ISPICKVAL(PRIORVALUE(Status),&quot;Submitted&quot;),
    ISPICKVAL(Status, &quot;In Progress&quot;),
	$Permission.Mid_Market_Project_Team_Status_Change_Access
   )
  ),
  NOT(
   AND(
    ISPICKVAL(PRIORVALUE(Status),&quot;In Progress&quot;),
    OR(ISPICKVAL(Status, &quot;Closed&quot;),ISPICKVAL(Status, &quot;Closed - Rejected&quot;),ISPICKVAL(Status, &quot;On Hold&quot;)),
	$Permission.Mid_Market_Project_Team_Status_Change_Access
   )
  ),
  NOT(
   AND(
    ISPICKVAL(PRIORVALUE(Status),&quot;Escalated&quot;),
    ISPICKVAL(Status, &quot;On Hold&quot;),
	$Permission.Mid_Market_Project_Team_Status_Change_Access
   )
  ),
  NOT(
   AND(
    ISPICKVAL(PRIORVALUE(Status),&quot;On Hold&quot;),
    OR(ISPICKVAL(Status, &quot;Closed&quot;),ISPICKVAL(Status, &quot;Closed - Rejected&quot;),ISPICKVAL(Status, &quot;In Progress&quot;)),
	$Permission.Mid_Market_Project_Team_Status_Change_Access
   )
  ),
  NOT(
   AND(
    ISPICKVAL(PRIORVALUE(Status),&quot;Closed - Rejected&quot;),
    ISPICKVAL(Status, &quot;New&quot;),
	$Permission.Mid_Market_Project_Team_Status_Change_Access
   )
  ),
  NOT(
   AND(    
    OR(ISPICKVAL(PRIORVALUE(Status), &quot;Closed&quot;),ISPICKVAL(PRIORVALUE(Status), &quot;Cancelled&quot;)),
	ISPICKVAL(Status,&quot;New&quot;)
   )
  )


)</errorConditionFormula>
    <errorMessage>You do not have access to change Case to this status since it can only set by the system</errorMessage>
</ValidationRule>
